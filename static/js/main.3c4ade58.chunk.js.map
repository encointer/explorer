{"version":3,"sources":["config/index.js","substrate-lib/SubstrateContext.js","substrate-lib/useSubstrate.js","substrate-lib/utils.js","substrate-lib/components/DeveloperConsole.js","MapMenu.js","MapBlockNumber.js","MapNodeInfo.js","MapControl.js","utils.js","MapSidebar.js","CommunitiesClusters.js","LocationsLayer.js","Map.js","App.js","index.js"],"names":["configEnv","require","envVars","reduce","mem","n","undefined","process","slice","config","configCommon","connectedSocket","queryString","parse","window","location","search","rpc","PROVIDER_SOCKET","console","log","INIT_STATE","socket","types","CUSTOM_TYPES","keyring","keyringState","api","apiState","reducer","state","action","type","payload","Error","SubstrateContext","React","createContext","SubstrateContextProvider","props","initState","forEach","key","useReducer","dispatch","Provider","value","children","useSubstrate","useContext","connect","useCallback","a","provider","WsProvider","_api","ApiPromise","on","isReady","then","loadAccounts","web3Enable","APP_NAME","web3Accounts","allAccounts","map","address","meta","name","source","loadAll","isDevelopment","DEVELOPMENT_KEYRING","error","useEffect","toFormat","BigJS","DeveloperConsole","util","util_crypto","MapMenu","Sidebar","as","Menu","animation","direction","icon","inverted","vertical","visible","width","Item","href","target","Icon","BlockNumber","finalized","useState","blockNumber","setBlockNumber","bestNumber","derive","chain","bestNumberFinalized","unsubscribeAll","number","toNumber","unsub","catch","Statistic","size","label","MapBlockNumberMain","Card","className","Content","MapBlockNumber","MapNodeInfoMain","nodeInfo","setNodeInfo","Promise","all","system","version","nodeName","nodeVersion","getInfo","style","header","MapNodeInfo","MapControl","loading","onZoomIn","onZoomOut","onClick","stackable","Button","disabled","Group","compact","parserFixPoint","upper","lower","len","assert","raw","precision","bitLength","bits","toString","lowerBits","length","padStart","floatPart","split","acc","bit","idx","upperBits","decimalPart","parseInt","negative","parseI32F32","parseI64F64","mapReduce","arr","mapperFn","reducerFn","result","batchFetch","apiMethod","ids","it","responses","BigFormat","Big","MapSidebarMain","debug","onClose","onShow","hash","data","cid","demurrage","ref","useRef","isVertical","bootstrappers","setBootstrappers","moneysupply","setMoneysupply","query","encointerCurrencies","_","toJSON","encointerBalances","totalIssuance","get","Segment","current","padded","Header","textAlign","sub","Message","color","toFixed","List","stacked","content","labelPosition","DivIcon","L","iconSize","html","selectedIcon","CommunitiesClusters","cids","selected","sourceTarget","options","alt","gps","isSelected","Marker","position","Tooltip","offset","mark","iconUrl","shadowUrl","iconAnchor","popupAnchor","shadowSize","LocationsLayer","coords","pos","initialPosition","parseLatLng","toLatLng","lat","lon","parseDemurrage","Math","exp","tileSetup","url","attribution","MapMain","mapRef","ui","setUI","setCids","setHash","setData","setPosition","ec","kvReducer","locations","currencyProperties","properties","getCenter","demurrage_per_block","name_utf8","handlerZoom","s","leafletElement","currencyIdentifiers","bs58","err","fetchGeodataPar","locate","setTimeout","invalidateSize","sidebarSize","Responsive","fireOnMount","onUpdate","portrait","onlyMobile","maxWidth","Pushable","menu","setZoom","prevZoom","Pusher","marginRight","display","center","zoom","zoomControl","touchZoom","height","container","offsetHeight","calcMapOffset","onLocationFound","e","latlng","flyTo","TileLayer","getZoom","bounds","pad","fitBounds","Map","Main","loader","text","Dimmer","active","Loader","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.3c4ade58.chunk.js","sourcesContent":["import configCommon from './common.json';\n// Using `require` as `import` does not support dynamic loading (yet).\nconst configEnv = require(`./${process.env.NODE_ENV}.json`);\n\n// Accepting React env vars and aggregating them into `config` object.\nconst envVarNames = [\n  'REACT_APP_PROVIDER_SOCKET',\n  'REACT_APP_DEVELOPMENT_KEYRING'\n];\nconst envVars = envVarNames.reduce((mem, n) => {\n  // Remove the `REACT_APP_` prefix\n  if (process.env[n] !== undefined) mem[n.slice(10)] = process.env[n];\n  return mem;\n}, {});\n\nconst config = { ...configCommon, ...configEnv, ...envVars };\nexport default config;\n","import React, { useReducer } from 'react';\nimport PropTypes from 'prop-types';\nimport queryString from 'query-string';\nimport config from '../config';\n\nconst parsedQuery = queryString.parse(window.location.search);\nconst connectedSocket = parsedQuery.rpc || config.PROVIDER_SOCKET;\nconsole.log(`Connected socket: ${connectedSocket}`);\n\nconst INIT_STATE = {\n  socket: connectedSocket,\n  types: config.CUSTOM_TYPES,\n  keyring: null,\n  keyringState: null,\n  api: null,\n  apiState: null\n};\n\nconst reducer = (state, action) => {\n  let socket = null;\n\n  switch (action.type) {\n    case 'RESET_SOCKET':\n      socket = action.payload || state.socket;\n      return { ...state, socket, api: null, apiState: null };\n\n    case 'CONNECT':\n      return { ...state, api: action.payload, apiState: 'CONNECTING' };\n\n    case 'CONNECT_SUCCESS':\n      return { ...state, apiState: 'READY' };\n\n    case 'CONNECT_ERROR':\n      return { ...state, apiState: 'ERROR' };\n\n    case 'SET_KEYRING':\n      return { ...state, keyring: action.payload, keyringState: 'READY' };\n\n    case 'KEYRING_ERROR':\n      return { ...state, keyring: null, keyringState: 'ERROR' };\n\n    default:\n      throw new Error(`Unknown type: ${action.type}`);\n  }\n};\n\nconst SubstrateContext = React.createContext();\n\nconst SubstrateContextProvider = (props) => {\n  // filtering props and merge with default param value\n  const initState = { ...INIT_STATE };\n  const neededPropNames = ['socket', 'types'];\n  neededPropNames.forEach(key => {\n    initState[key] = (typeof props[key] === 'undefined' ? initState[key] : props[key]);\n  });\n  const [state, dispatch] = useReducer(reducer, initState);\n\n  return (\n    <SubstrateContext.Provider value={[state, dispatch]}>\n      {props.children}\n    </SubstrateContext.Provider>\n  );\n};\n\n// prop typechecking\nSubstrateContextProvider.propTypes = {\n  socket: PropTypes.string,\n  types: PropTypes.object\n};\n\nexport { SubstrateContext, SubstrateContextProvider };\n","import { useContext, useEffect, useCallback } from 'react';\nimport { ApiPromise, WsProvider } from '@polkadot/api';\nimport { web3Accounts, web3Enable } from '@polkadot/extension-dapp';\nimport keyring from '@polkadot/ui-keyring';\n\nimport config from '../config';\nimport { SubstrateContext } from './SubstrateContext';\n\nconst useSubstrate = () => {\n  const [state, dispatch] = useContext(SubstrateContext);\n\n  // `useCallback` so that returning memoized function and not created\n  //   everytime, and thus re-render.\n  const { api, socket, types } = state;\n  const connect = useCallback(async () => {\n    if (api) return;\n\n    const provider = new WsProvider(socket);\n    const _api = new ApiPromise({ provider, types });\n\n    // We want to listen to event for disconnection and reconnection.\n    //  That's why we set for listeners.\n    _api.on('connected', () => {\n      dispatch({ type: 'CONNECT', payload: _api });\n      // `ready` event is not emitted upon reconnection. So we check explicitly here.\n      _api.isReady.then((_api) => dispatch({ type: 'CONNECT_SUCCESS' }));\n    });\n    _api.on('ready', () => dispatch({ type: 'CONNECT_SUCCESS' }));\n    _api.on('error', () => dispatch({ type: 'CONNECT_ERROR' }));\n  }, [api, socket, types, dispatch]);\n\n  // hook to get injected accounts\n  const { keyringState } = state;\n  const loadAccounts = useCallback(async () => {\n    // Ensure the method only run once.\n    if (keyringState) return;\n\n    try {\n      await web3Enable(config.APP_NAME);\n      let allAccounts = await web3Accounts();\n      allAccounts = allAccounts.map(({ address, meta }) =>\n        ({ address, meta: { ...meta, name: `${meta.name} (${meta.source})` } }));\n\n      keyring.loadAll({ isDevelopment: config.DEVELOPMENT_KEYRING }, allAccounts);\n      dispatch({ type: 'SET_KEYRING', payload: keyring });\n    } catch (e) {\n      console.error(e);\n      dispatch({ type: 'KEYRING_ERROR' });\n    }\n  }, [keyringState, dispatch]);\n\n  useEffect(() => {\n    connect();\n  }, [connect]);\n\n  useEffect(() => {\n    loadAccounts();\n  }, [loadAccounts]);\n\n  return { ...state, dispatch };\n};\n\nexport default useSubstrate;\n","import BigJS from 'big.js';\nimport toFormat from 'toformat';\n\nconst Big = toFormat(BigJS);\n\nconst utils = {\n  prettyBalance: function (amt, opts = {}) {\n    if (typeof amt !== 'number' && typeof amt !== 'string') {\n      throw new Error(`${amt} is not a number`);\n    }\n\n    // default option values\n    opts = { power: 8, decimal: 2, unit: 'Units', ...opts };\n\n    const bn = Big(amt);\n    const divisor = Big(10).pow(opts.power);\n    const displayed = bn.div(divisor).toFormat(opts.decimal);\n    return `${displayed.toString()} ${opts.unit}`;\n  }\n};\n\nexport default utils;\n","// This component will simply add utility functions to your developer console.\nimport { useSubstrate } from '../';\n\nexport default function DeveloperConsole (props) {\n  const { api } = useSubstrate();\n  window.api = api;\n  window.util = require('@polkadot/util');\n  window.util_crypto = require('@polkadot/util-crypto');\n  window.keyring = require('@polkadot/keyring');\n\n  return null;\n}\n","import React from 'react';\nimport { Sidebar, Menu, Icon } from 'semantic-ui-react';\n\nexport default function MapMenu (props) {\n  return (\n    <Sidebar\n      as={Menu}\n      animation='overlay'\n      direction='left'\n      icon='labeled'\n      inverted\n      vertical\n      visible={props.visible}\n      width='thin'\n    >\n\n      <Menu.Item as='a' href='//encointer.org' target='_blank'>\n        <Icon name='book' />\n            Documentation\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//encointer.org/testnet/' target='_blank' >\n        <Icon name='block layout' />\n            Testnet\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//encointer.org/blog/' target='_blank'>\n        <Icon name='newspaper' />\n            Blog\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//encointer.org/faq/' target='_blank'>\n        <Icon name='question circle' />\n            FAQ\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//encointer.org/donate/' target='_blank'>\n        <Icon name='dollar' />\n           Donate\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//encointer.org/about/' target='_blank'>\n        <Icon name='favorite' />\n           About\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//github.com/encointer/encointer-node' target='_blank'>\n        <Icon name='github' />\n            Code\n      </Menu.Item>\n\n    </Sidebar>\n  );\n}\n","import React, { useEffect, useState } from 'react';\nimport { Statistic, Card } from 'semantic-ui-react';\n\nimport { useSubstrate } from './substrate-lib';\n\nfunction BlockNumber (props) {\n  const { api } = useSubstrate();\n  const { finalized } = props;\n  const [blockNumber, setBlockNumber] = useState(0);\n\n  const bestNumber = finalized\n    ? api.derive.chain.bestNumberFinalized\n    : api.derive.chain.bestNumber;\n\n  useEffect(() => {\n    let unsubscribeAll = null;\n\n    bestNumber(number => {\n      setBlockNumber(number.toNumber());\n    })\n      .then(unsub => {\n        unsubscribeAll = unsub;\n      })\n      .catch(console.error);\n\n    return () => unsubscribeAll && unsubscribeAll();\n  }, [bestNumber]);\n\n  return (\n    <Statistic size='small'\n      label={(finalized ? 'Finalized' : 'Current') + ' Block'}\n      value={blockNumber}\n    />\n  );\n}\n\nfunction MapBlockNumberMain (props) {\n  return (\n    <Card className='encointer-map-block-number'>\n      <Card.Content>\n        <BlockNumber finalized={true} />\n        <BlockNumber />\n      </Card.Content>\n    </Card>\n  );\n}\n\nexport default function MapBlockNumber (props) {\n  const { api } = useSubstrate();\n  return api.derive &&\n    api.derive.chain &&\n    api.derive.chain.bestNumber &&\n    api.derive.chain.bestNumberFinalized ? (\n      <MapBlockNumberMain {...props} />\n    ) : null;\n}\n","import React, { useEffect, useState } from 'react';\nimport { Card } from 'semantic-ui-react';\n\nimport { useSubstrate } from './substrate-lib';\n\nfunction MapNodeInfoMain (props) {\n  const { api } = useSubstrate();\n  const [nodeInfo, setNodeInfo] = useState({});\n\n  useEffect(() => {\n    const getInfo = async () => {\n      try {\n        const [chain, nodeName, nodeVersion] = await Promise.all([\n          api.rpc.system.chain(),\n          api.rpc.system.name(),\n          api.rpc.system.version()\n        ]);\n        setNodeInfo({ chain, nodeName, nodeVersion });\n      } catch (e) {\n        console.error(e);\n      }\n    };\n    getInfo();\n  }, [api.rpc.system]);\n\n  return (nodeInfo.nodeName\n    ? <Card className='encointer-map-node-info'\n      style={props.style || {}}\n      header={nodeInfo.nodeName}\n      meta={`${nodeInfo.chain || ''} v${nodeInfo.nodeVersion}`}\n    /> : null);\n}\n\nexport default function MapNodeInfo (props) {\n  const { api } = useSubstrate();\n  return api.rpc &&\n    api.rpc.system &&\n    api.rpc.system.chain &&\n    api.rpc.system.name &&\n    api.rpc.system.version ? (\n      <MapNodeInfoMain {...props} />\n    ) : null;\n}\n","import React from 'react';\nimport { Button, Menu } from 'semantic-ui-react';\n\nexport default function MapControl (props) {\n  const { loading, onZoomIn, onZoomOut, onClick } = props;\n  return (\n    <Menu className='encointer-map-floating-widgets' stackable size='mini' vertical>\n      <Menu.Item >\n        <Button onClick={onClick} loading={loading} disabled={loading} icon='sidebar' className='encoiner-menu-button' />\n      </Menu.Item>\n      <Menu.Item >\n        <Button.Group vertical compact size='small'>\n          <Button icon='plus' onClick={onZoomIn}/>\n          <Button icon='minus' onClick={onZoomOut}/>\n        </Button.Group>\n      </Menu.Item>\n    </Menu>\n  );\n}\n","import assert from 'assert';\n\n/// Function to produce function to convert fixed-point to Number\n///\n/// Fixed interpretation of u<N> place values\n/// ... ___ ___ ___ ___ . ___ ___ ___ ___ ...\n/// ...  8   4   2   1    1/2 1/4 1/8 1/16...\n///\n/// Parameters:\n/// upper: 0..128 - number of bits in decimal part\n/// lower: 0..128 - number of bits in fractional part\n///\n/// Produced function parameters:\n/// raw: substrate_fixed::types::I<upper>F<lower> as I<upper+lower>\n/// precision: 0..lower number bits in fractional part to process\nexport function parserFixPoint (upper, lower) {\n  const len = upper + lower;\n  assert(len >= 8, `Bit length can't be less than 8, provided ${len}`);\n  assert(len <= 128, `Bit length can't be bigger than 128, provided ${len}`);\n  assert(!(len & (len - 1)), `Bit length should be power of 2, provided ${len}`);\n\n  return (raw, precision = lower) => {\n    assert(raw.bitLength() === len, 'Bit length is not equal to ' + len);\n    const bits = raw.toString(2, len);\n    const lowerBits = (lower > bits.length\n      ? bits.padStart(lower, '0')\n      : bits).slice(-lower, -1 * (lower - precision) || undefined);\n    const floatPart = lowerBits\n      .split('')\n      .reduce((acc, bit, idx) => {\n        acc = acc + (bit === '1' ? 1 / 2 ** (idx + 1) : 0);\n        return acc;\n      }, 0);\n    const upperBits = bits.slice(0, -lower);\n    const decimalPart = upperBits ? parseInt(upperBits, 2) : 0;\n    return decimalPart + (raw.negative ? -floatPart : floatPart);\n  };\n}\n\nexport const parseI4F4 = parserFixPoint(4, 4);\n\nexport const parseI8F8 = parserFixPoint(8, 8);\n\nexport const parseI16F16 = parserFixPoint(16, 16);\n\nexport const parseI32F32 = parserFixPoint(32, 32);\n\nexport const parseI64F64 = parserFixPoint(64, 64);\n\n/// map and reduce helper\nfunction mapReduce (arr, mapperFn, reducerFn) {\n  let result = arr;\n  if (mapperFn) {\n    result = result.map(mapperFn);\n  }\n  if (reducerFn) {\n    result = result.reduce(reducerFn, {});\n  }\n  return result;\n}\n\n/// Function that calls provided api method parameters provided in ids array\n/// Will return value when all promises finishes optionally converted with mapperFn\nexport async function batchFetch (apiMethod, ids, mapperFn, reducerFn) {\n  const responses = await Promise.all(ids.map(it => apiMethod(it))); // array of fetching promises\n  return mapReduce(responses, mapperFn, reducerFn); // Called when all promises fullfils\n}\n","import React, { useEffect, useState, useRef } from 'react';\nimport { Button, Segment, Header, Icon, List, Message, Sidebar } from 'semantic-ui-react';\nimport Big from 'big.js';\nimport toFormat from 'toformat';\n\nimport { useSubstrate } from './substrate-lib';\nimport { parseI64F64 } from './utils';\n\nconst BigFormat = toFormat(Big);\n\nfunction MapSidebarMain (props) {\n  const {\n    debug, onClose, onShow, hash, direction, width, data: {\n      name, cid, demurrage\n    }\n  } = props;\n  const visible = !!hash.length;\n  const ref = useRef();\n  const isVertical = direction === 'top' || direction === 'bottom';\n\n  const { api } = useSubstrate();\n  const [bootstrappers, setBootstrappers] = useState([]);\n  const [moneysupply, setMoneysupply] = useState(null);\n\n  /// Fetch bootstrappers\n  useEffect(() => {\n    if (cid) {\n      debug && console.log('GETTING BOOTSTRAPPERS', cid);\n      api.query.encointerCurrencies\n        .bootstrappers(cid)\n        .then(_ => {\n          debug && console.log('BOOTSTRAPPERS RECEIVED', _);\n          setBootstrappers(_.toJSON());\n        });\n    }\n  }, [api.query.encointerCurrencies, cid, debug]);\n\n  /// Fetch money supply\n  useEffect(() => {\n    if (cid) {\n      debug && console.log('GETTING MONEYSUPPLY', cid);\n      api.query.encointerBalances\n        .totalIssuance(cid)\n        .then(_ => {\n          debug && console.log('MONEYSUPPLY RECEIVED', _);\n          setMoneysupply(parseI64F64(_.get('principal')));\n        });\n    }\n  }, [api.query.encointerBalances, cid, debug]);\n\n  /// Handler when sidebar completely shows (animation stops)\n  const handleShow = () => ref.current && onShow(ref.current.ref.current[\n    `offset${isVertical ? 'Height' : 'Width'}`\n  ]);\n\n  return (\n    <Sidebar\n      className='details-sidebar'\n      ref={ref}\n      as={Segment.Group}\n      animation='overlay'\n      icon='labeled'\n\n      direction={direction}\n      visible={visible}\n      width={width}\n      onShow={handleShow}\n    >\n      <Segment padded>\n        <Header>\n          <Icon name='money bill alternate' />\n          <Header.Content>Currency info</Header.Content>\n        </Header>\n      </Segment>\n\n      <Segment textAlign='center'>\n        <Header sub textAlign='left'>Currency ID:</Header>\n        <Message size='small' color='blue'>{hash}</Message>\n        <p>{name}</p>\n      </Segment>\n\n      <Segment.Group>\n\n        <Segment>\n          <Header sub>Demurrage rate (per month):</Header>\n          {demurrage && demurrage.toFixed(2)}%\n        </Segment>\n\n        <Segment loading={!bootstrappers.length}>\n          <Header sub>List of bootstrappers:</Header>\n          <List>{\n            bootstrappers.map(\n              _ => <List.Item key={_}>{_}</List.Item>\n            )\n          }</List>\n        </Segment>\n\n        <Segment loading={moneysupply === null} stacked>\n          <Header sub>Money supply:</Header>\n          <p>{ moneysupply && (new BigFormat(moneysupply)).toFormat(2) }</p>\n        </Segment>\n\n      </Segment.Group>\n\n      <Segment textAlign='right' className='map-sidebar-close'>\n        <Button\n          content='Close'\n          icon={'angle ' + (isVertical ? 'down' : 'right')}\n          labelPosition='right'\n          onClick={onClose}/>\n      </Segment>\n\n    </Sidebar>\n  );\n}\n\nexport default function MapBlockNumber (props) {\n  const { api } = useSubstrate();\n  return api.query &&\n    api.query.encointerCurrencies &&\n    api.query.encointerBalances ? (\n      <MapSidebarMain {...props} />\n    ) : null;\n}\n","import React from 'react';\nimport { Marker, Tooltip } from 'react-leaflet';\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\nimport * as L from 'leaflet';\n\nconst DivIcon = L.divIcon;\nconst iconSize = [30, 30];\n\nconst icon = new DivIcon({\n  iconSize,\n  className: 'encoiner-community-icon',\n  html: '<i>$</i>'\n});\nconst selectedIcon = new DivIcon({\n  iconSize: [2, 2],\n  className: '',\n  html: ''\n});\n\n/// communities markers layer with clusterisation\nexport function CommunitiesClusters (props) {\n  const { cids, data, selected } = props;\n  const handleMarkerClick = _ => _.sourceTarget.options.alt && props.onClick(_.sourceTarget.options.alt);\n  return (<MarkerClusterGroup onClick={handleMarkerClick}> {\n    cids.map(cid => {\n      const { gps, name } = data[cid];\n      const isSelected = selected === cid;\n      return (\n        <Marker key={cid} position={gps} alt={cid} icon={ isSelected ? selectedIcon : icon } >\n          { !isSelected\n            ? <Tooltip direction='top' offset={[0, iconSize[1] / -2]}>{name}</Tooltip>\n            : null }\n        </Marker>\n      );\n    })\n  }</MarkerClusterGroup>);\n}\n","import React from 'react';\nimport { Marker } from 'react-leaflet';\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\nimport * as L from 'leaflet';\n\nconst mark = new L.Icon({\n  iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41]\n});\n\n/// Markers layer\nexport function LocationsLayer (props) {\n  const { coords } = props.data;\n  if (!coords || !coords.length) {\n    return null;\n  }\n  return (<MarkerClusterGroup>{\n    coords.map((pos, idx) => (<Marker position={pos} key={idx} icon={mark}/>))\n  }</MarkerClusterGroup>);\n}\n","import React, { useEffect, useState, useRef } from 'react';\nimport { Map as LMap, TileLayer } from 'react-leaflet';\nimport { Sidebar, Responsive, Segment } from 'semantic-ui-react';\nimport * as L from 'leaflet';\nimport * as bs58 from 'bs58';\n\nimport { useSubstrate } from './substrate-lib';\nimport { DeveloperConsole } from './substrate-lib/components';\n\nimport MapMenu from './MapMenu';\nimport MapBlockNumber from './MapBlockNumber';\nimport MapNodeInfo from './MapNodeInfo';\nimport MapControl from './MapControl';\nimport MapSidebar from './MapSidebar';\n\nimport { CommunitiesClusters } from './CommunitiesClusters';\nimport { LocationsLayer } from './LocationsLayer';\nimport { parseI32F32, parseI64F64, batchFetch } from './utils';\n\nimport 'leaflet/dist/leaflet.css';\nimport 'react-leaflet-markercluster/dist/styles.min.css';\n\nconst initialPosition = L.latLng(47.166168, 8.515495);\n\n/// Parse only 16 bits of fractional part\nconst parseLatLng = _ => parseI32F32(_, 16);\n\nconst toLatLng = location => [\n  parseLatLng(location.lat),\n  parseLatLng(location.lon)\n];\n\nconst BLOCKS_PER_MONTH = (86400 / 6) * (356 / 12);\n\nconst parseDemurrage = _ => (1 - Math.exp(-1 * parseI64F64(_) * BLOCKS_PER_MONTH)) * 100;\n\nconst tileSetup = {\n  url: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  attribution: '&copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>'\n};\n\nfunction MapMain (props) {\n  const { debug } = props;\n  const mapRef = useRef();\n  const { api } = useSubstrate();\n\n  const [ui, setUI] = useState({ selected: '', loading: true });\n  const [cids, setCids] = useState([]);\n  const [hash, setHash] = useState([]);\n  const [data, setData] = useState({});\n  const [position, setPosition] = useState(initialPosition);\n\n  const ec = api && api.query && api.query.encointerCurrencies;\n\n  /// Fetch locations for each currency in paralel; Save to state once ready\n  async function fetchGeodataPar (cids, hash) { /* eslint-disable no-multi-spaces */\n    const kvReducer = (acc, data, idx) => { // conver array to key-value map\n      acc[hash[idx]] = data;                // where key is BASE58 of cid\n      return acc;\n    };\n\n    debug && console.log('FETCHING LOCATIONS AND PROPERTIES');\n    const [locations, properties] = await Promise.all([\n      await batchFetch(         // Fetching all Locations in parallel\n        ec.locations,           // API: encointerCurrencies.locations(cid) -> Vec<Location>\n        cids,                   // array of parameters to method\n        _ => _.map(toLatLng)    // convert Location from I32F32 to LatLng\n      ),                        // Fetching all Currency Properties\n      await batchFetch(ec.currencyProperties, cids)]);\n\n    debug && console.log('SETTING DATA', locations, properties);\n    setData(cids.map((cid, idx) => ({ // Shape of data in UI\n      cid,                            // cid for back-reference\n      coords: locations[idx],         // all coords\n      gps: L.latLngBounds(locations[idx]).getCenter(),\n      demurrage: parseDemurrage(properties[idx].demurrage_per_block),\n      name: properties[idx].name_utf8.toString()\n    })).reduce(kvReducer, {}));\n    setUI({ ...ui, loading: false });\n  }\n\n  /// Load currencies identifiers once\n  useEffect(() => {\n    if (cids.length === 0) {\n      ec.currencyIdentifiers()\n        .then(cids => {\n          setCids(cids);\n          setHash(cids.map(bs58.encode));\n        })\n        .catch(err => console.error(err));\n    }\n  }, [cids.length, ec]);\n\n  /// Get locations effect\n  useEffect(() => { /* eslint-disable react-hooks/exhaustive-deps */\n    if (cids.length && cids.length === hash.length) {\n      fetchGeodataPar(cids, hash);\n    }\n  }, [cids, hash]);\n\n  /// Attempt geolocation\n  useEffect(() => {\n    const map = mapRef.current;\n    if (map != null && position === initialPosition) {\n      map.leafletElement.locate();\n    }\n  }, [mapRef, position]);\n\n  /// Update map after resize\n  useEffect(_ => {\n    const map = mapRef.current && mapRef.current.leafletElement;\n    map && setTimeout(_ => map.invalidateSize(), 50);\n  }, [ui.sidebarSize]);\n\n  /// Handler generator for zoom in/out\n  function handlerZoom (s) {\n    return () => mapRef.current.leafletElement[s < 0 ? 'zoomOut' : 'zoomIn']();\n  }\n\n  /// Resize leaflet map when sidebar shown\n  function calcMapOffset () {\n    const full = '100%';\n    // should reposition markers in portrait mode if sidebar shown\n    if (ui.portrait && ui.selected && ui.sidebarSize && mapRef.current !== null) {\n      const offset = mapRef.current.container.offsetHeight - ui.sidebarSize;\n      return `${offset}px`;\n    }\n    return full;\n  }\n\n  /// Restet marker to my position\n  const handleLocationFound = e => {\n    setPosition(e.latlng);\n    const map = mapRef.current.leafletElement;\n    map.flyTo(e.latlng);\n    map.setZoom(8);\n  };\n\n  /// Handler for click on currency marker\n  const handleCurrencyMarkerClick = cid => {\n    const map = mapRef.current.leafletElement;\n    setUI({ ...ui, selected: cid, prevZoom: map.getZoom() });\n    const bounds = L.latLngBounds(data[cid].coords).pad(2);\n    map.fitBounds(bounds);\n  };\n\n  /// Handler for window resize\n  const handleResponsibleUpdate = (_, { width }) =>\n    setUI({ ...ui, portrait: width < Responsive.onlyMobile.maxWidth, width });\n\n  /// Handler for sidebar closing\n  const handleSidebarClosed = _ => {\n    const map = mapRef.current.leafletElement;\n    map.setZoom(ui.prevZoom);\n    setUI({ ...ui, selected: '', sidebarSize: 0 });\n  };\n\n  /// Handler for sidebar shows completely\n  const handleSidebarShow = sidebarSize =>\n    setUI({ ...ui, sidebarSize, menu: false });\n\n  /// Show left side menu\n  const toggleMenu = () =>\n    setUI({ ...ui, menu: !ui.menu });\n\n  /// Close left side menu if clicked\n  const handleMapClick = () =>\n    ui.menu && setUI({ ...ui, menu: false });\n\n  return (\n    <Responsive\n      as={Segment.Group}\n      className='encointer-map'\n      fireOnMount\n      onUpdate={handleResponsibleUpdate}>\n\n      <Sidebar.Pushable as={Segment}  className='component-wrapper'>\n\n        <MapMenu visible={ui.menu} />\n\n        <MapSidebar\n          onClose={handleSidebarClosed}\n          onShow={handleSidebarShow}\n          hash={ui.selected}\n          direction={ui.portrait ? 'bottom' : 'right'}\n          width='very wide'\n          data={data[ui.selected] || {}}\n          debug={debug}\n        />\n\n        <Sidebar.Pusher className='encointer-map-wrapper'\n          style={{ marginRight: ui.portrait ? '0' : ui.sidebarSize + 'px' }}>\n\n          <MapBlockNumber />\n\n          <MapNodeInfo\n            style={ui.portrait && ui.selected ? { display: 'none' } : {}} />\n\n          <MapControl\n            onClick={toggleMenu}\n            loading={ui.loading}\n            onZoomIn={handlerZoom(1)}\n            onZoomOut={handlerZoom(-1)} />\n\n          <LMap\n            center={position}\n            zoom={4}\n            ref={mapRef}\n            zoomControl={false}\n            touchZoom={true}\n            onClick={handleMapClick}\n            style={{ height: calcMapOffset() }}\n            onLocationFound={handleLocationFound}>\n\n            <TileLayer {...tileSetup} />\n\n            { ui.selected\n              ? <LocationsLayer data={data[ui.selected]} />\n              : null }\n\n            { !ui.loading\n              ? <CommunitiesClusters\n                data={data}\n                cids={hash}\n                onClick={handleCurrencyMarkerClick}\n                selected={ui.selected} />\n              : null }\n\n          </LMap>\n\n        </Sidebar.Pusher>\n\n      </Sidebar.Pushable>\n\n      { debug\n        ? <DeveloperConsole />\n        : null }\n\n    </Responsive>\n  );\n}\n\nexport default function Map (props) {\n  const { api } = useSubstrate();\n  return api && api.query && api.query.encointerCurrencies ? <MapMain {...props} /> : null;\n}\n","import React from 'react';\nimport { Dimmer, Loader } from 'semantic-ui-react';\n\nimport 'semantic-ui-css/semantic.min.css';\nimport { SubstrateContextProvider, useSubstrate } from './substrate-lib';\n\nimport Map from './Map';\nimport './style.css';\n\nfunction Main () {\n  const { apiState, keyringState } = useSubstrate();\n\n  const loader = text => (\n    <Dimmer active>\n      <Loader size='small'>{text}</Loader>\n    </Dimmer>\n  );\n\n  if (apiState === 'ERROR') return loader('Error connecting to the blockchain');\n  else if (apiState !== 'READY') return loader('Connecting to the blockchain');\n\n  if (keyringState !== 'READY') {\n    return loader(\n      \"Loading accounts (please review any extension's authorization)\"\n    );\n  }\n\n  return (<Map debug />);\n}\n\nexport default function App () {\n  return (\n    <SubstrateContextProvider>\n      <Main />\n    </SubstrateContextProvider>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(<App />,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}
{"version":3,"sources":["config/index.js","substrate-lib/SubstrateContext.js","substrate-lib/useSubstrate.js","substrate-lib/utils.js","substrate-lib/components/DeveloperConsole.js","map/MapMenu.js","map/CeremonyPhaseTimer.jsx","map/MapCeremonyPhases.jsx","map/MapNodeInfo.js","map/MapControl.js","utils.js","map/MapSidebar.js","map/MarkerIcon.js","map/CommunitiesClusters.js","map/LocationsLayer.js","Map.js","App.js","index.js"],"names":["configEnv","require","envVars","reduce","mem","n","undefined","process","slice","config","configCommon","connectedSocket","queryString","parse","window","location","search","rpc","PROVIDER_SOCKET","console","log","INIT_STATE","socket","types","CUSTOM_TYPES","keyring","keyringState","api","apiState","reducer","state","action","type","payload","Error","SubstrateContext","React","createContext","SubstrateContextProvider","props","initState","forEach","key","useReducer","dispatch","Provider","value","children","useSubstrate","useContext","connect","useCallback","a","provider","WsProvider","_api","ApiPromise","on","isReady","then","loadAccounts","web3Enable","APP_NAME","web3Accounts","allAccounts","map","address","meta","name","source","loadAll","isDevelopment","DEVELOPMENT_KEYRING","error","useEffect","toFormat","BigJS","DeveloperConsole","util","util_crypto","memo","Sidebar","as","Menu","animation","direction","icon","inverted","vertical","visible","width","Item","href","target","Icon","prev","cur","phaseTimestampToTimer","timestamp","timeSec","Date","now","toString","padStart","CeremonyPhaseTimer","nextPhaseTimestamp","useState","timer","setTimer","id","setInterval","clearInterval","Fragment","ceremonyPhases","formatStartingAt","toLocaleString","formatDate","small","participantCount","meetupCount","attestationCount","currentPhase","phase","counter","className","Step","Group","ordered","unstackable","join","size","phasesProps","idx","active","concat","toLowerCase","filter","prop","reverse","phasesSteps","Content","Title","Label","circular","color","Description","newProp","oldProp","Blocks","blockNumber","setBlockNumber","bestNumber","finalized","derive","chain","bestNumberFinalized","unsubscribeAll","toNumber","unsub","catch","_","CeremonyIndex","getCurrentCeremonyIndex","query","encointerScheduler","currentCeremonyIndex","setCurrentCeremonyIndex","newCeremonyIndex","MapNodeInfoMain","nodeInfo","setNodeInfo","system","Promise","all","version","nodeName","nodeVersion","getInfo","Card","style","Header","Meta","Loader","inline","MapNodeInfo","loading","onZoomIn","onZoomOut","onClick","stackable","Button","disabled","compact","parserFixPoint","upper","lower","len","assert","raw","precision","bitLength","bits","lowerBits","length","floatPart","split","acc","bit","upperBits","decimalPart","parseInt","negative","parseI32F32","parseI64F64","mapReduce","arr","mapperFn","reducerFn","result","batchFetch","apiMethod","ids","it","responses","BigFormat","Big","MapSidebarMain","debug","onClose","onShow","hash","lastParticipantCount","lastMeetupCount","data","cid","demurrage","ref","useRef","isVertical","bootstrappers","setBootstrappers","moneysupply","setMoneysupply","encointerCurrencies","toJSON","encointerBalances","totalIssuance","get","Segment","current","padded","textAlign","sub","Message","horizontal","toFixed","stacked","List","content","labelPosition","DivIcon","L","markerClassName","clusterClassName","iconSize","count","html","communityIcon","clusterIcon","iconActive","iconActivePulse","iconSemiactivePulse","iconSemiactive","iconInactive","locationMarker","iconUrl","shadowUrl","iconAnchor","popupAnchor","shadowSize","getClusterIcon","iconSet","green","yellow","red","getIcon","iconClass","createClusterCustomIcon","cluster","markers","getAllChildMarkers","options","markerCount","getChildCount","initialState","timers","byCID","tid","clearTimeout","CommunitiesClusters","cids","selected","subscribtionPhase","counters","attestations","gps","meetups","position","attests","marker","newMarkers","setTimeout","push","leafletElement","refreshClusters","sourceTarget","alt","iconCreateFunction","chunkedLoading","Object","keys","Marker","Tooltip","offset","attest","timeout","LocationsLayer","coords","pos","initialPosition","parseLatLng","toLatLng","lat","lon","parseDemurrage","Math","exp","tileSetup","url","attribution","apiReady","queryName","queryMulti","sumUp","obj","subscribtionCeremony","lastCeremony","participants","subscribtions","setters","Map","mapRef","menu","ui","setUI","setCids","setHash","setData","setPosition","setCurrentPhase","ceremonyIndex","setCeremonyIndex","ec","es","kvReducer","locations","currencyProperties","properties","getCenter","demurrage_per_block","name_utf8","handlerZoom","s","getCurrentPhase","getNextPhaseTimestamp","setPhase","newPhase","newPhaseTimestamp","timeToNext","CurrencyCeremony","registry","getOrUnknown","fetchHistoricData","ceremony","encointerCeremonies","getParticipantCount","getMeetupCount","oldPhase","currencyCeremony","getter","bs58","fetchLastCeremony","U32","lastCeremonyData","subscribeToUpdates","ceremonyNumber","getAttestationCount","getters","unsubs","currencyIdentifiers","hashes","err","fetchGeodataPar","locate","invalidateSize","sidebarSize","Responsive","fireOnMount","onUpdate","portrait","onlyMobile","maxWidth","Pushable","MapMenu","MapSidebar","setZoom","prevZoom","Pusher","marginRight","display","center","zoom","zoomControl","touchZoom","height","container","offsetHeight","calcMapOffset","onLocationFound","e","latlng","flyTo","TileLayer","getZoom","bounds","pad","fitBounds","Main","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.7d6830f0.chunk.js","sourcesContent":["import configCommon from './common.json';\n// Using `require` as `import` does not support dynamic loading (yet).\nconst configEnv = require(`./${process.env.NODE_ENV}.json`);\n\n// Accepting React env vars and aggregating them into `config` object.\nconst envVarNames = [\n  'REACT_APP_PROVIDER_SOCKET',\n  'REACT_APP_DEVELOPMENT_KEYRING'\n];\nconst envVars = envVarNames.reduce((mem, n) => {\n  // Remove the `REACT_APP_` prefix\n  if (process.env[n] !== undefined) mem[n.slice(10)] = process.env[n];\n  return mem;\n}, {});\n\nconst config = { ...configCommon, ...configEnv, ...envVars };\nexport default config;\n","import React, { useReducer } from 'react';\nimport PropTypes from 'prop-types';\nimport queryString from 'query-string';\nimport config from '../config';\n\nconst parsedQuery = queryString.parse(window.location.search);\nconst connectedSocket = parsedQuery.rpc || config.PROVIDER_SOCKET;\nconsole.log(`Connected socket: ${connectedSocket}`);\n\nconst INIT_STATE = {\n  socket: connectedSocket,\n  types: config.CUSTOM_TYPES,\n  keyring: null,\n  keyringState: null,\n  api: null,\n  apiState: null\n};\n\nconst reducer = (state, action) => {\n  let socket = null;\n\n  switch (action.type) {\n    case 'RESET_SOCKET':\n      socket = action.payload || state.socket;\n      return { ...state, socket, api: null, apiState: null };\n\n    case 'CONNECT':\n      return { ...state, api: action.payload, apiState: 'CONNECTING' };\n\n    case 'CONNECT_SUCCESS':\n      return { ...state, apiState: 'READY' };\n\n    case 'CONNECT_ERROR':\n      return { ...state, apiState: 'ERROR' };\n\n    case 'SET_KEYRING':\n      return { ...state, keyring: action.payload, keyringState: 'READY' };\n\n    case 'KEYRING_ERROR':\n      return { ...state, keyring: null, keyringState: 'ERROR' };\n\n    default:\n      throw new Error(`Unknown type: ${action.type}`);\n  }\n};\n\nconst SubstrateContext = React.createContext();\n\nconst SubstrateContextProvider = (props) => {\n  // filtering props and merge with default param value\n  const initState = { ...INIT_STATE };\n  const neededPropNames = ['socket', 'types'];\n  neededPropNames.forEach(key => {\n    initState[key] = (typeof props[key] === 'undefined' ? initState[key] : props[key]);\n  });\n  const [state, dispatch] = useReducer(reducer, initState);\n\n  return (\n    <SubstrateContext.Provider value={[state, dispatch]}>\n      {props.children}\n    </SubstrateContext.Provider>\n  );\n};\n\n// prop typechecking\nSubstrateContextProvider.propTypes = {\n  socket: PropTypes.string,\n  types: PropTypes.object\n};\n\nexport { SubstrateContext, SubstrateContextProvider };\n","import { useContext, useEffect, useCallback } from 'react';\nimport { ApiPromise, WsProvider } from '@polkadot/api';\nimport { web3Accounts, web3Enable } from '@polkadot/extension-dapp';\nimport keyring from '@polkadot/ui-keyring';\n\nimport config from '../config';\nimport { SubstrateContext } from './SubstrateContext';\n\nconst useSubstrate = () => {\n  const [state, dispatch] = useContext(SubstrateContext);\n\n  // `useCallback` so that returning memoized function and not created\n  //   everytime, and thus re-render.\n  const { api, socket, types } = state;\n  const connect = useCallback(async () => {\n    if (api) return;\n\n    const provider = new WsProvider(socket);\n    const _api = new ApiPromise({ provider, types });\n\n    // We want to listen to event for disconnection and reconnection.\n    //  That's why we set for listeners.\n    _api.on('connected', () => {\n      dispatch({ type: 'CONNECT', payload: _api });\n      // `ready` event is not emitted upon reconnection. So we check explicitly here.\n      _api.isReady.then((_api) => dispatch({ type: 'CONNECT_SUCCESS' }));\n    });\n    _api.on('ready', () => dispatch({ type: 'CONNECT_SUCCESS' }));\n    _api.on('error', () => dispatch({ type: 'CONNECT_ERROR' }));\n  }, [api, socket, types, dispatch]);\n\n  // hook to get injected accounts\n  const { keyringState } = state;\n  const loadAccounts = useCallback(async () => {\n    // Ensure the method only run once.\n    if (keyringState) return;\n\n    try {\n      await web3Enable(config.APP_NAME);\n      let allAccounts = await web3Accounts();\n      allAccounts = allAccounts.map(({ address, meta }) =>\n        ({ address, meta: { ...meta, name: `${meta.name} (${meta.source})` } }));\n\n      keyring.loadAll({ isDevelopment: config.DEVELOPMENT_KEYRING }, allAccounts);\n      dispatch({ type: 'SET_KEYRING', payload: keyring });\n    } catch (e) {\n      console.error(e);\n      dispatch({ type: 'KEYRING_ERROR' });\n    }\n  }, [keyringState, dispatch]);\n\n  useEffect(() => {\n    connect();\n  }, [connect]);\n\n  useEffect(() => {\n    loadAccounts();\n  }, [loadAccounts]);\n\n  return { ...state, dispatch };\n};\n\nexport default useSubstrate;\n","import BigJS from 'big.js';\nimport toFormat from 'toformat';\n\nconst Big = toFormat(BigJS);\n\nconst utils = {\n  prettyBalance: function (amt, opts = {}) {\n    if (typeof amt !== 'number' && typeof amt !== 'string') {\n      throw new Error(`${amt} is not a number`);\n    }\n\n    // default option values\n    opts = { power: 8, decimal: 2, unit: 'Units', ...opts };\n\n    const bn = Big(amt);\n    const divisor = Big(10).pow(opts.power);\n    const displayed = bn.div(divisor).toFormat(opts.decimal);\n    return `${displayed.toString()} ${opts.unit}`;\n  }\n};\n\nexport default utils;\n","// This component will simply add utility functions to your developer console.\nimport { useSubstrate } from '../';\n\nexport default function DeveloperConsole (props) {\n  const { api } = useSubstrate();\n  window.api = api;\n  window.util = require('@polkadot/util');\n  window.util_crypto = require('@polkadot/util-crypto');\n  window.keyring = require('@polkadot/keyring');\n\n  return null;\n}\n","import React from 'react';\nimport { Sidebar, Menu, Icon } from 'semantic-ui-react';\n\nfunction MapMenuMain (props) {\n  return (\n    <Sidebar\n      as={Menu}\n      animation='overlay'\n      direction='left'\n      icon='labeled'\n      inverted\n      vertical\n      visible={props.visible}\n      width='thin'\n    >\n\n      <Menu.Item as='a' href='//encointer.org' target='_blank'>\n        <Icon name='book' />\n            Documentation\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//encointer.org/testnet/' target='_blank' >\n        <Icon name='block layout' />\n            Testnet\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//encointer.org/blog/' target='_blank'>\n        <Icon name='newspaper' />\n            Blog\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//encointer.org/faq/' target='_blank'>\n        <Icon name='question circle' />\n            FAQ\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//encointer.org/donate/' target='_blank'>\n        <Icon name='dollar' />\n           Donate\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//encointer.org/about/' target='_blank'>\n        <Icon name='favorite' />\n           About\n      </Menu.Item>\n\n      <Menu.Item as='a' href='//github.com/encointer/encointer-node' target='_blank'>\n        <Icon name='github' />\n            Code\n      </Menu.Item>\n\n    </Sidebar>\n  );\n}\n\nexport default React.memo(MapMenuMain, (prev, cur) => prev.visible === cur.visible);\n","import React, { useEffect, useState } from 'react';\n\nconst phaseTimestampToTimer = (timestamp) => {\n  const timeSec = ((timestamp - Date.now()) / 1000) | 0;\n  if (timeSec >= 0) {\n    return `${((timeSec / 60) | 0).toString().padStart(2, '0')}:${(timeSec % 60).toString().padStart(2, '0')}`;\n  } else {\n    return 'finished';\n  }\n};\n\nexport function CeremonyPhaseTimer (props) {\n  const { nextPhaseTimestamp } = props;\n  const [timer, setTimer] = useState('');\n\n  useEffect(() => {\n    setTimer(phaseTimestampToTimer(nextPhaseTimestamp));\n    const id = setInterval(() => {\n      setTimer(phaseTimestampToTimer(nextPhaseTimestamp));\n    }, 1000);\n    return () => clearInterval(id);\n  }, [nextPhaseTimestamp]);\n\n  return <React.Fragment>{timer}</React.Fragment>;\n}\n","import React from 'react';\nimport { Step, Label } from 'semantic-ui-react';\nimport { CeremonyPhaseTimer } from './CeremonyPhaseTimer';\n\nconst ceremonyPhases = [\n  'REGISTERING',\n  'ASSIGNING',\n  'ATTESTING'\n];\n\nconst formatDate = (timestamp) => (new Date(timestamp)).toLocaleString();\n\nconst formatStartingAt = (timestamp) => (<div><div>starting at:</div> {formatDate(timestamp)}</div>);\n\nexport default React.memo(function MapCeremonyPhases (props) {\n  const {\n    small,\n    participantCount,\n    meetupCount,\n    attestationCount,\n    currentPhase: {\n      phase: currentPhase,\n      timestamp\n    }\n  } = props;\n\n  const counter = [participantCount, meetupCount, attestationCount];\n\n  const phasesSteps = phase => {\n    const phasesProps = (currentPhase === -1 ? [] : ceremonyPhases)\n      .map((phase, idx) => ({\n        key: ceremonyPhases[idx],\n        counter: counter[idx],\n        active: (idx === currentPhase),\n        className: 'step-'.concat(ceremonyPhases[idx]).toLowerCase()\n      })).filter((prop, idx) =>\n        !small || prop.active || idx === currentPhase + 1 || (idx === 0 && currentPhase === 2)\n      );\n    return (small && currentPhase === 2) ? phasesProps.reverse() : phasesProps;\n  };\n\n  return (<div className='encointer-map-ceremony-phase'>\n    <Step.Group\n      ordered\n      unstackable\n      className={[\n        ceremonyPhases[currentPhase],\n        small ? 'small-screen' : ''\n      ].join(' ')}\n      size='mini'>{\n        phasesSteps(currentPhase)\n          .map((props, idx) => (\n            <Step {...props}>\n              <Step.Content>\n                <Step.Title>\n                  {props.key} {\n                    (idx <= currentPhase && props.counter) ? <Label circular color={props.active ? 'green' : 'grey'}>{props.counter}</Label> : null\n                  }</Step.Title>\n                <Step.Description>{\n                  (props.active)\n                    ? <div><div>time left: </div><CeremonyPhaseTimer nextPhaseTimestamp={timestamp} /></div>\n                    : (small\n                      ? formatStartingAt(timestamp)\n                      : ((idx === (currentPhase + 1) ||\n                          (idx === 0 && currentPhase === 2))\n                        ? formatStartingAt(timestamp)\n                        : null))\n                }</Step.Description>\n              </Step.Content>\n            </Step>\n          ))\n      }</Step.Group>\n  </div>);\n}, (newProp, oldProp) => {\n  return (oldProp.small === newProp.small &&\n          oldProp.participantCount === newProp.participantCount &&\n          oldProp.meetupCount === newProp.meetupCount &&\n          oldProp.attestationCount === newProp.attestationCount &&\n          oldProp.currentPhase.phase === newProp.currentPhase.phase &&\n          oldProp.currentPhase.timestamp === newProp.currentPhase.timestamp);\n});\n","import React, { useEffect, useState } from 'react';\nimport { Card, Loader } from 'semantic-ui-react';\n\nimport { useSubstrate } from '../substrate-lib';\n\nconst Blocks = React.memo(props => {\n  const { api } = useSubstrate();\n  const [blockNumber, setBlockNumber] = useState(0);\n  const bestNumber = props.finalized\n    ? api.derive.chain.bestNumberFinalized\n    : api.derive.chain.bestNumber;\n  useEffect(() => {\n    let unsubscribeAll;\n    bestNumber(blockNumber => {\n      setBlockNumber(blockNumber.toNumber());\n    }).then(unsub => {\n      unsubscribeAll = unsub;\n    })\n      .catch(console.error);\n    return () => unsubscribeAll && unsubscribeAll();\n  }, [bestNumber]);\n  return <React.Fragment>{blockNumber}</React.Fragment>;\n}, _ => true);\n\nconst CeremonyIndex = React.memo(props => {\n  const {\n    api: {\n      query: {\n        encointerScheduler: {\n          currentCeremonyIndex: getCurrentCeremonyIndex\n        }\n      }\n    }\n  } = useSubstrate();\n  const [currentCeremonyIndex, setCurrentCeremonyIndex] = useState(0);\n  useEffect(() => {\n    let unsubscribeAll;\n    getCurrentCeremonyIndex(newCeremonyIndex => {\n      setCurrentCeremonyIndex(newCeremonyIndex.toNumber());\n    }).then(unsub => {\n      unsubscribeAll = unsub;\n    })\n      .catch(console.error);\n    return () => unsubscribeAll && unsubscribeAll();\n  }, [getCurrentCeremonyIndex]);\n  return (currentCeremonyIndex\n    ? <React.Fragment>\n      <span>ceremony</span> <strong> #{currentCeremonyIndex}</strong>\n    </React.Fragment>\n    : null);\n}, _ => true);\n\nfunction MapNodeInfoMain (props) {\n  const { apiState, api } = useSubstrate();\n  const [nodeInfo, setNodeInfo] = useState({});\n  const system = api && api.rpc && api.rpc.system;\n  const getCurrentCeremonyIndex = api && api.query && api.query.encointerScheduler &&\n        api.query.encointerScheduler.currentCeremonyIndex;\n\n  useEffect(() => {\n    if (system) {\n      const getInfo = async () => {\n        try {\n          const [chain, nodeName, nodeVersion] = await Promise.all([\n            system.chain(),\n            system.name(),\n            system.version()\n          ]);\n          setNodeInfo({ chain, nodeName, nodeVersion });\n        } catch (e) {\n          console.error(e);\n        }\n      };\n      getInfo();\n    }\n  }, [system]);\n\n  return (\n    <Card className='encointer-map-node-info' style={props.style || {}}>{\n      apiState === 'READY'\n        ? <React.Fragment>\n          <Card.Content>\n            <Card.Header>{nodeInfo.nodeName}</Card.Header>\n            <Card.Meta>{`${nodeInfo.chain || ''} v${nodeInfo.nodeVersion}`}</Card.Meta>\n          </Card.Content>\n          <Card.Content className='blocks'>\n            {\n              getCurrentCeremonyIndex\n                ? <React.Fragment>\n                  <Card.Meta></Card.Meta>\n                  <div className='block-current'>current block #<Blocks /></div>\n                  <div className='finalized-current'>finalized block #<Blocks finalized /></div>\n                  <div className='ceremony'><CeremonyIndex /></div>\n                </React.Fragment>\n                : <React.Fragment>\n                  <div className='loading'>\n                    <Loader active size='medium' inline='centered' />\n                  </div>\n                </React.Fragment>\n            }\n          </Card.Content>\n        </React.Fragment>\n        : <Card.Content className='loading'>\n          {\n            apiState !== 'ERROR'\n              ? <Card.Meta><Loader active size='small' inline /> Connecting to the blockchain</Card.Meta>\n              : <Card.Meta>Error connecting to the blockchain</Card.Meta>\n          }\n        </Card.Content>\n    }</Card>\n  );\n}\n\nexport default function MapNodeInfo (props) {\n  return <MapNodeInfoMain {...props} />;\n}\n","import React from 'react';\nimport { Button, Menu } from 'semantic-ui-react';\n\nfunction MapControl (props) {\n  const { loading, onZoomIn, onZoomOut, onClick } = props;\n  return (\n    <Menu className='encointer-map-floating-widgets' stackable size='mini' vertical>\n      <Menu.Item >\n        <Button onClick={onClick} loading={loading} disabled={loading} icon='sidebar' className='encoiner-menu-button' />\n      </Menu.Item>\n      <Menu.Item >\n        <Button.Group vertical compact size='small'>\n          <Button icon='plus' onClick={onZoomIn}/>\n          <Button icon='minus' onClick={onZoomOut}/>\n        </Button.Group>\n      </Menu.Item>\n    </Menu>\n  );\n}\n\nexport default React.memo(MapControl, (prev, cur) => prev.loading === cur.loading);\n","import assert from 'assert';\n\n/// Function to produce function to convert fixed-point to Number\n///\n/// Fixed interpretation of u<N> place values\n/// ... ___ ___ ___ ___ . ___ ___ ___ ___ ...\n/// ...  8   4   2   1    1/2 1/4 1/8 1/16...\n///\n/// Parameters:\n/// upper: 0..128 - number of bits in decimal part\n/// lower: 0..128 - number of bits in fractional part\n///\n/// Produced function parameters:\n/// raw: substrate_fixed::types::I<upper>F<lower> as I<upper+lower>\n/// precision: 0..lower number bits in fractional part to process\nexport function parserFixPoint (upper, lower) {\n  const len = upper + lower;\n  assert(len >= 8, `Bit length can't be less than 8, provided ${len}`);\n  assert(len <= 128, `Bit length can't be bigger than 128, provided ${len}`);\n  assert(!(len & (len - 1)), `Bit length should be power of 2, provided ${len}`);\n\n  return (raw, precision = lower) => {\n    assert(raw.bitLength() === len, 'Bit length is not equal to ' + len);\n    const bits = raw.toString(2, len);\n    const lowerBits = (lower > bits.length\n      ? bits.padStart(lower, '0')\n      : bits).slice(-lower, -1 * (lower - precision) || undefined);\n    const floatPart = lowerBits\n      .split('')\n      .reduce((acc, bit, idx) => {\n        acc = acc + (bit === '1' ? 1 / 2 ** (idx + 1) : 0);\n        return acc;\n      }, 0);\n    const upperBits = bits.slice(0, -lower);\n    const decimalPart = upperBits ? parseInt(upperBits, 2) : 0;\n    return decimalPart + (raw.negative ? -floatPart : floatPart);\n  };\n}\n\nexport const parseI4F4 = parserFixPoint(4, 4);\n\nexport const parseI8F8 = parserFixPoint(8, 8);\n\nexport const parseI16F16 = parserFixPoint(16, 16);\n\nexport const parseI32F32 = parserFixPoint(32, 32);\n\nexport const parseI64F64 = parserFixPoint(64, 64);\n\n/// map and reduce helper\nfunction mapReduce (arr, mapperFn, reducerFn) {\n  let result = arr;\n  if (mapperFn) {\n    result = result.map(mapperFn);\n  }\n  if (reducerFn) {\n    result = result.reduce(reducerFn, {});\n  }\n  return result;\n}\n\n/// Function that calls provided api method parameters provided in ids array\n/// Will return value when all promises finishes optionally converted with mapperFn\nexport async function batchFetch (apiMethod, ids, mapperFn, reducerFn) {\n  const responses = await Promise.all(ids.map(it => apiMethod(it))); // array of fetching promises\n  return mapReduce(responses, mapperFn, reducerFn); // Called when all promises fullfils\n}\n","import React, { useEffect, useState, useRef } from 'react';\nimport { Button, Segment, Header, Icon, List, Message, Sidebar } from 'semantic-ui-react';\nimport Big from 'big.js';\nimport toFormat from 'toformat';\n\nimport { useSubstrate } from '../substrate-lib';\nimport { parseI64F64 } from '../utils';\n\nconst BigFormat = toFormat(Big);\n\nfunction MapSidebarMain (props) {\n  const {\n    debug,\n    onClose,\n    onShow,\n    hash,\n    direction,\n    width,\n    participantCount,\n    lastParticipantCount,\n    lastMeetupCount,\n    meetupCount,\n    data: {\n      name, cid, demurrage\n    }\n  } = props;\n  const visible = !!hash.length;\n  const ref = useRef();\n  const isVertical = direction === 'top' || direction === 'bottom';\n\n  const { api } = useSubstrate();\n  const [bootstrappers, setBootstrappers] = useState([]);\n  const [moneysupply, setMoneysupply] = useState(null);\n\n  /// Fetch bootstrappers\n  useEffect(() => {\n    if (cid) {\n      debug && console.log('GETTING BOOTSTRAPPERS', cid);\n      api.query.encointerCurrencies\n        .bootstrappers(cid)\n        .then(_ => {\n          debug && console.log('BOOTSTRAPPERS RECEIVED', _);\n          setBootstrappers(_.toJSON());\n        });\n    }\n  }, [api.query.encointerCurrencies, cid, debug]);\n\n  /// Fetch money supply\n  useEffect(() => {\n    if (cid) {\n      debug && console.log('GETTING MONEYSUPPLY', cid);\n      api.query.encointerBalances\n        .totalIssuance(cid)\n        .then(_ => {\n          debug && console.log('MONEYSUPPLY RECEIVED', _);\n          setMoneysupply(parseI64F64(_.get('principal')));\n        });\n    }\n  }, [api.query.encointerBalances, cid, debug]);\n\n  /// Handler when sidebar completely shows (animation stops)\n  const handleShow = () => ref.current && onShow(ref.current.ref.current[\n    `offset${isVertical ? 'Height' : 'Width'}`\n  ]);\n\n  return (\n    <Sidebar\n      className='details-sidebar'\n      ref={ref}\n      as={Segment.Group}\n      animation='overlay'\n      icon='labeled'\n\n      direction={direction}\n      visible={visible}\n      width={width}\n      onShow={handleShow}\n    >\n      <Segment padded>\n        <Header>\n          <Icon name='money bill alternate' />\n          <Header.Content>Currency info</Header.Content>\n        </Header>\n      </Segment>\n\n      <Segment textAlign='center'>\n        <Header sub textAlign='left'>Currency ID:</Header>\n        <Message size='small' color='blue'>{hash}</Message>\n        <p>{name}</p>\n      </Segment>\n\n      <Segment.Group>\n\n        <Segment.Group horizontal>\n          <Segment>\n            <Header sub>Demurrage rate (per month):</Header>\n            {demurrage && demurrage.toFixed(2)}%\n            <Header sub>participants registered:</Header>\n            {participantCount}\n            <Header sub>participants registered in last ceremony:</Header>\n            {lastParticipantCount}\n          </Segment>\n          <Segment>\n            <Header sub>Money supply:</Header>\n            <p>{ moneysupply && (new BigFormat(moneysupply)).toFormat(2) }</p>\n            <Header sub>meetups assigned:</Header>\n            {meetupCount}\n            <Header sub>meetups assigned in last ceremony:</Header>\n            {lastMeetupCount}\n          </Segment>\n        </Segment.Group>\n\n        <Segment loading={!bootstrappers.length} stacked>\n          <Header sub>List of bootstrappers:</Header>\n          <List>{\n            bootstrappers.map(\n              _ => <List.Item key={_}>{_}</List.Item>\n            )\n          }</List>\n        </Segment>\n\n      </Segment.Group>\n\n      <Segment textAlign='right' className='map-sidebar-close'>\n        <Button\n          content='Close'\n          icon={'angle ' + (isVertical ? 'down' : 'right')}\n          labelPosition='right'\n          onClick={onClose}/>\n      </Segment>\n\n    </Sidebar>\n  );\n}\n\nexport default React.memo(function MapBlockNumber (props) {\n  const { api } = useSubstrate();\n  return api && api.query &&\n    api.query.encointerCurrencies &&\n    api.query.encointerBalances ? (\n      <MapSidebarMain {...props} />\n    ) : null;\n}, (prev, cur) => (\n  prev.hash === cur.hash && (\n    cur.hash\n      ? prev.participantCount === cur.participantCount &&\n      prev.lastParticipantCount === cur.lastParticipantCount &&\n      prev.meetupCount === cur.meetupCount &&\n      prev.lastMeetupCount === cur.lastMeetupCount\n      : true)\n));\n","import * as L from 'leaflet';\n\nconst DivIcon = L.divIcon;\n\nconst commonClassName = 'marker-cluster marker-cluster-small ';\nconst markerClassName = commonClassName.concat('encoiner-community-icon');\nconst clusterClassName = commonClassName.concat('encoiner-cluster-custom');\n\nconst iconSize = [40, 40];\n\nexport const icon = (className, count) => new DivIcon({\n  iconSize,\n  className: ''.concat(className),\n  html: '<div><span>'.concat(count, '</span></div>')\n});\n\nexport const communityIcon = (className) => icon(markerClassName.concat(' ', className), '$');\n\nexport const clusterIcon = (className, count) => icon(clusterClassName.concat(' ', className), count);\n\nexport const iconActive = communityIcon('');\n\nexport const iconActivePulse = communityIcon('pulse');\n\nexport const iconSemiactivePulse = communityIcon('yellow pulse');\n\nexport const iconSemiactive = communityIcon('yellow');\n\nexport const iconInactive = communityIcon('red');\n\nexport const locationMarker = new L.Icon({\n  iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41]\n});\n\nexport const getClusterIcon = (phase, count, active) => {\n  let className;\n  if (phase === 0) { // in REGISTERING phase\n    className = count ? 'green' : 'yellow'; // green if >0 registered\n  } else if (count !== 0) {\n    className = count > 1 ? 'green' : 'yellow'; // if 1 meetup then yellow, if >1 green\n  } else {\n    className = 'red'; // in ASSIGNING and ATTESTING if 0 meetups\n  }\n  if (active) { // animated icon\n    return className.concat(' pulse');\n  } else {\n    return className;\n  }\n};\n","import React, { useEffect, useRef, useReducer } from 'react';\nimport { Marker, Tooltip } from 'react-leaflet';\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\nimport { iconActive, iconActivePulse, iconSemiactive, iconSemiactivePulse, iconInactive, clusterIcon, getClusterIcon } from './MarkerIcon';\n\nconst pulseTimer = 3000;\nconst iconSize = [40, 40];\n\nconst iconSet = {\n  'green pulse': iconActivePulse,\n  'yellow pulse': iconSemiactivePulse,\n  'red pulse': iconSemiactivePulse,\n  green: iconActive,\n  yellow: iconSemiactive,\n  red: iconInactive\n};\n\nconst getIcon = (phase, count, active) => {\n  const iconClass = getClusterIcon(phase, count, active);\n  return iconSet[iconClass];\n};\n\nconst createClusterCustomIcon = function (cluster) {\n  const markers = cluster.getAllChildMarkers();\n  const phase = markers[0].options.phase;\n  const count = markers\n    .map(it => it.options.count)\n    .reduce((acc, it) => it > acc ? it : acc, 0);\n  const active = markers\n    .map(it => it.options.active)\n    .reduce((acc, it) => it || acc, false);\n\n  const iconClass = getClusterIcon(phase, count, active);\n  const markerCount = cluster.getChildCount();\n  return clusterIcon(iconClass, markerCount);\n};\n\nconst initialState = {\n  timers: {},\n  byCID: {},\n  phase: -1\n};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'initialize':\n      return ((state, action) => {\n        const { phase, byCID } = action.payload;\n        return { ...state, byCID, phase };\n      })(state, action);\n\n    case 'phase':\n      return { ...state, phase: action.payload };\n\n    case 'reset':\n      return ((state, action) => {\n        const { phase, byCID } = action.payload;\n        const markers = { ...state.byCID };\n        for (const cid in markers) {\n          markers[cid].count = byCID[cid] || 0;\n        }\n        return { ...state, byCID: markers, phase };\n      })(state, action);\n\n    case 'activate':\n      return ((state, action) => {\n        const { payload } = action;\n        const { timers } = payload;\n        const byCID = { ...state.byCID, ...payload.byCID };\n        for (const tid in timers) {\n          state.timers[tid] && clearTimeout(state.timers[tid]);\n        }\n        return { ...state, byCID, timers: { ...state.timers, ...timers } };\n      })(state, action);\n\n    case 'deactivate':\n      return ((state, action) => {\n        const cid = action.payload;\n        const byCID = { ...state.byCID };\n        const timers = { ...state.timers };\n        byCID[cid] = { ...byCID[cid], active: false };\n        clearTimeout(timers[cid]);\n        timers[cid] = 0;\n        return { ...state, byCID, timers };\n      })(state, action);\n    default:\n      return state;\n  }\n};\n\n/// communities markers layer with clusterization\nexport function CommunitiesClusters (props) {\n  const { cids, data, selected, state } = props;\n  const [markers, dispatch] = useReducer(reducer, initialState);\n  const ref = useRef(null);\n  const handleMarkerClick = _ => _.sourceTarget.options.alt && props.onClick(_.sourceTarget.options.alt);\n  const phase = state.subscribtionPhase;\n  const counters = state[['participants', 'meetups', 'meetups'][phase]]; // counter for each phase is meetups\n  const attestations = state.attestations; // counter for ATTESTING phase is meetups\n  const byCID = markers.byCID;\n\n  /// Init markers\n  if (markers.phase === -1 && phase !== -1) {\n    const byCID = cids.map((cid, idx) => {\n      const { gps, name } = data[cid];\n      const meetups = state.meetups[cid] || 0;\n      const count = phase ? meetups : (counters[cid] || 0);\n      const attests = phase === 2 ? (attestations[cid] || 0) : 0;\n      return {\n        name,\n        key: cid,\n        position: gps,\n        active: false,\n        count,\n        attests\n      };\n    }).reduce((acc, marker) => {\n      acc[marker.key] = marker;\n      return acc;\n    }, {});\n    dispatch({ type: 'initialize', payload: { byCID, phase } });\n  } else if (phase > markers.phase || (phase === 0 && markers.phase === 2)) {\n    /// Reset counters\n    dispatch({ type: 'reset', payload: { byCID: counters, phase } });\n  }\n\n  /// Update counters\n  useEffect(() => { /* eslint-disable react-hooks/exhaustive-deps */\n    const newMarkers = {};\n    const timers = {};\n    cids.forEach((cid) => {\n      const counter = counters ? (counters[cid] || 0) : 0;\n      const attests = attestations ? attestations[cid] : 0;\n      if (markers.byCID[cid].count < counter ||\n          markers.byCID[cid].attests < attests) {\n        newMarkers[cid] = markers.byCID[cid];\n        newMarkers[cid].count = counter;\n        newMarkers[cid].attests = attestations[cid] || 0;\n        newMarkers[cid].active = true;\n        timers[cid] = setTimeout(() => {\n          dispatch({ type: 'deactivate', payload: cid });\n        }, pulseTimer);\n      }\n    });\n    dispatch({ type: 'activate', payload: { byCID: newMarkers, timers } });\n  }, [counters, attestations, cids]);\n\n  // Update clusters\n  useEffect(() => {\n    let tid;\n    const active = [];\n    for (const cid in markers.byCID) {\n      if (markers.byCID[cid].active) {\n        active.push(cid);\n      }\n    }\n    if (active.length) {\n      tid = setTimeout(() => { // redraw clusters\n        if (ref.current !== null && ref.current.leafletElement) {\n          ref.current.leafletElement.refreshClusters();\n        }\n      }, 10);\n    }\n\n    return () => {\n      tid && clearTimeout(tid);\n    };\n  }, [byCID]);\n\n  return (\n    <MarkerClusterGroup ref={ref} onClick={handleMarkerClick}\n      iconCreateFunction={createClusterCustomIcon}\n      chunkedLoading={true}\n    >{\n        Object.keys(byCID).map(cid => {\n          const { key, position, name, active, count, attests } = byCID[cid];\n          const isSelected = selected === cid;\n          return (isSelected ? null : <Marker\n            key={key.concat(phase, attests, count, active ? 'force-redraw' : '')}\n            position={position}\n            alt={cid}\n            count={count}\n            active={active}\n            phase={phase}\n            attests={attests}\n            icon={ getIcon(markers.phase, count, active) }>\n            <Tooltip direction='top' offset={[0, iconSize[1] / -2]}>{name}</Tooltip>\n          </Marker>);\n        })\n      }</MarkerClusterGroup>);\n}\n","import React, { useReducer, useEffect, useRef } from 'react';\nimport { Marker } from 'react-leaflet';\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\n\nimport { locationMarker, clusterIcon, getClusterIcon } from './MarkerIcon';\n\nconst pulseTimer = 3000;\n\nconst createClusterCustomIcon = function (cluster) {\n  const markers = cluster.getAllChildMarkers();\n  const phase = markers[0].options.phase;\n  const count = markers[0].options.count;\n  const active = markers[0].options.active;\n  const markerCount = markers.length;\n  return clusterIcon(getClusterIcon(phase, count, active), markerCount);\n};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'reset':\n      return { active: false, count: 0, attest: 0, timeout: state.timeout };\n    case 'activate':\n      return ((state, action) => {\n        const { count, timeout, attest } = action.payload;\n        return { ...state, active: true, count, attest, timeout };\n      })(state, action);\n    case 'deactivate':\n      return ((state, action) => {\n        clearTimeout(state.timeout);\n        return { ...state, active: false };\n      })(state, action);\n    default:\n      return state;\n  }\n};\n\n/// Markers layer\nexport function LocationsLayer (props) {\n  const { phase, meetupCount, participantCount, attestationCount: attest } = props;\n  const { coords } = props.data;\n  const ref = useRef(null);\n  const count = phase === 0 ? participantCount : meetupCount;\n  const [state, dispatch] = useReducer(reducer, { active: false, count, attest });\n\n  const active = state.active;\n\n  /// Trigger active\n  useEffect(() => {\n    if (count === 0 && phase === 0 && (state.attest > 0 || state.count > 0)) {\n      dispatch({ type: 'reset' });\n      return;\n    }\n    if (state.count < count || state.attest < attest) {\n      const timeout = setTimeout(() => {\n        dispatch({ type: 'deactivate' });\n      }, pulseTimer);\n      dispatch({ type: 'activate', payload: { count, timeout, attest } });\n    }\n  }, [state, count, attest, phase]);\n\n  // Update clusters\n  useEffect(() => {\n    let tid;\n    if (active) {\n      tid = setTimeout(() => { // redraw clusters\n        if (ref.current !== null && ref.current.leafletElement) {\n          ref.current.leafletElement.refreshClusters();\n        }\n      }, 10);\n    }\n\n    return () => {\n      tid && clearTimeout(tid);\n    };\n  }, [active]);\n\n  if (!coords || !coords.length) {\n    return null;\n  }\n\n  return (<MarkerClusterGroup ref={ref} iconCreateFunction={createClusterCustomIcon}>{\n    coords.map((pos, idx) => (\n      <Marker\n        position={pos}\n        key={''.concat(idx, count, attest, active ? 'force-redraw' : '')}\n        phase={phase}\n        count={count}\n        attest={state.attest}\n        active={active}\n        icon={locationMarker} />))\n  }</MarkerClusterGroup>);\n}\n","import React, { useEffect, useState, useRef, useReducer } from 'react';\nimport { Map as LMap, TileLayer } from 'react-leaflet';\nimport { Sidebar, Responsive, Segment } from 'semantic-ui-react';\nimport * as L from 'leaflet';\nimport * as bs58 from 'bs58';\nimport { u32 as U32 } from '@polkadot/types/primitive';\n\nimport { useSubstrate } from './substrate-lib';\nimport { DeveloperConsole } from './substrate-lib/components';\n\nimport MapMenu from './map/MapMenu';\nimport MapCeremonyPhases from './map/MapCeremonyPhases';\nimport MapNodeInfo from './map/MapNodeInfo';\nimport MapControl from './map/MapControl';\nimport MapSidebar from './map/MapSidebar';\n\nimport { CommunitiesClusters } from './map/CommunitiesClusters';\nimport { LocationsLayer } from './map/LocationsLayer';\nimport { parseI32F32, parseI64F64, batchFetch } from './utils';\n\nimport 'leaflet/dist/leaflet.css';\nimport 'react-leaflet-markercluster/dist/styles.min.css';\n\nconst initialPosition = L.latLng(47.166168, 8.515495);\n\n/// Parse only 16 bits of fractional part\nconst parseLatLng = _ => parseI32F32(_, 16);\n\nconst toLatLng = location => [\n  parseLatLng(location.lat),\n  parseLatLng(location.lon)\n];\n\nconst BLOCKS_PER_MONTH = (86400 / 6) * (356 / 12);\n\nconst parseDemurrage = _ => (1 - Math.exp(-1 * parseI64F64(_) * BLOCKS_PER_MONTH)) * 100;\n\nconst tileSetup = {\n  url: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  attribution: '&copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>'\n};\n\nconst apiReady = (api, queryName = '') => {\n  const query = api && api.queryMulti && api.query;\n  return query && queryName ? (!!query[queryName]) : !!query;\n};\n\n// Ceremony Phases\nconst ceremonyPhases = {\n  REGISTERING: 0,\n  ASSIGNING: 1,\n  ATTESTING: 2\n};\n\nconst sumUp = obj => Object.keys(obj).reduce((acc, it) => { acc = acc + obj[it]; return acc; }, 0);\n\nconst initialState = {\n  subscribtionCeremony: 0,\n  subscribtionPhase: -1,\n  lastCeremony: {\n    participants: {},\n    meetups: {},\n    attestations: {}\n  },\n  subscribtions: [],\n  participantCount: 0,\n  meetupCount: 0,\n  attestationCount: 0,\n  participants: {},\n  meetups: {},\n  attestations: {}\n};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'unsubscribeAll':\n      state.subscribtions.forEach(unsub => unsub());\n      return { ...state, subscribtions: [] };\n\n    case 'subscribe':\n      state.subscribtions.forEach(unsub => unsub());\n      return { ...state, ...action.payload };\n\n    case 'participants':\n      return ((state, action) => {\n        const participants = { ...state.participants, [action.payload.cid]: action.payload.count };\n        const participantCount = sumUp(participants);\n        return { ...state, participants, participantCount };\n      })(state, action);\n\n    case 'meetups':\n      return ((state, action) => {\n        const meetups = { ...state.meetups, [action.payload.cid]: action.payload.count };\n        const meetupCount = sumUp(meetups);\n        return { ...state, meetups, meetupCount };\n      })(state, action);\n\n    case 'attestations':\n      return ((state, action) => {\n        const attestations = { ...state.attestations, [action.payload.cid]: action.payload.count };\n        const attestationCount = sumUp(attestations);\n        return {\n          ...state,\n          attestations,\n          attestationCount\n        };\n      })(state, action);\n\n    case 'last':\n      return {\n        ...state,\n        lastCeremony: action.payload\n      };\n\n    case 'reset':\n      state.subscribtions.forEach(unsub => unsub());\n      if (state.subscribtionCeremony && state.subscribtionCeremony !== state.lastCeremony.subscribtionCeremony) {\n        return {\n          ...initialState,\n          lastCeremony: {\n            subscribtionCeremony: state.subscribtionCeremony,\n            meetups: { ...state.meetups },\n            meetupCount: state.meetupCount,\n            attestations: { ...state.attestations },\n            attestationCount: state.attestationCount,\n            participants: { ...state.participants },\n            participantCount: state.participantCount,\n            subscribtions: null,\n            lastCeremony: null\n          }\n        };\n      } else {\n        return state;\n      }\n\n    default:\n      throw new Error('unknown action '.concat(action.type));\n  }\n};\n\nconst setters = ['participants', 'meetups', 'attestations']; // action names for each phase\n\nexport default function Map (props) {\n  const { debug } = props;\n  const mapRef = useRef();\n  const { api } = useSubstrate();\n\n  const [ui, setUI] = useState({ selected: '', loading: true, menu: false });\n  const [cids, setCids] = useState([]);\n  const [hash, setHash] = useState([]);\n  const [data, setData] = useState({});\n  const [position, setPosition] = useState(initialPosition);\n  const [currentPhase, setCurrentPhase] = useState({ phase: -1, timestamp: 0, timer: null });\n  const [ceremonyIndex, setCeremonyIndex] = useState(0);\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  const ec = api && api.query && api.query.encointerCurrencies;\n  const es = api && api.query && api.query.encointerScheduler;\n\n  /// Fetch locations for each currency in parallel; Save to state once ready\n  async function fetchGeodataPar (cids, hash) { /* eslint-disable no-multi-spaces */\n    const kvReducer = (acc, data, idx) => { // convert array to key-value map\n      acc[hash[idx]] = data;                // where key is BASE58 of cid\n      return acc;\n    };\n\n    debug && console.log('FETCHING LOCATIONS AND PROPERTIES');\n    const [locations, properties] = await Promise.all([\n      await batchFetch(         // Fetching all Locations in parallel\n        ec.locations,           // API: encointerCurrencies.locations(cid) -> Vec<Location>\n        cids,                   // array of parameters to method\n        _ => _.map(toLatLng)    // convert Location from I32F32 to LatLng\n      ),                        // Fetching all Currency Properties\n      await batchFetch(ec.currencyProperties, cids)]);\n\n    debug && console.log('SETTING DATA', locations, properties);\n    setData(cids.map((cid, idx) => ({ // Shape of data in UI\n      cid,                            // cid for back-reference\n      coords: locations[idx],         // all coords\n      gps: L.latLngBounds(locations[idx]).getCenter(),\n      demurrage: parseDemurrage(properties[idx].demurrage_per_block),\n      name: properties[idx].name_utf8.toString()\n    })).reduce(kvReducer, {}));\n    setUI({ ...ui, loading: false });\n  }\n\n  /// Update current phase and set update timeout\n  useEffect(() => {\n    debug && console.log('phases', currentPhase);\n    if (!apiReady(api, 'encointerScheduler')) {\n      return;\n    }\n\n    const {\n      encointerScheduler: {\n        currentPhase: getCurrentPhase,\n        nextPhaseTimestamp: getNextPhaseTimestamp\n      }\n    } = api.query;\n\n    const setPhase = (phase, timestamp, timer) => {\n      (currentPhase.phase !== phase || currentPhase.timestamp !== timestamp || !timer) &&\n        setCurrentPhase({ phase, timestamp, timer });\n    };\n\n    if (!currentPhase.timer) {\n      api.queryMulti([\n        getCurrentPhase,\n        getNextPhaseTimestamp\n      ])\n        .then(([newPhase, newPhaseTimestamp]) => {\n          const phase = newPhase.toNumber();\n          const timestamp = newPhaseTimestamp.toNumber();\n          let timeToNext = timestamp - Date.now() + 500;\n          if (timeToNext <= 0) {\n            timeToNext = 3000; // delay if timestamp in the past\n          }\n          const timer = currentPhase.timer === null && // reset phase timer\n                setTimeout(() => setPhase(phase, timestamp, null), timeToNext);\n          timer && setPhase(phase, timestamp, timer); // update if have new timer\n        })\n        .catch(console.error);\n    }\n    return () => {\n      currentPhase.timer && clearTimeout(currentPhase.timer);\n    };\n  }, [currentPhase, debug, es, api]);\n\n  /// Update ceremony index once registration phase starts\n  useEffect(() => { /* eslint-disable react-hooks/exhaustive-deps */\n    if (!apiReady(api, 'encointerScheduler')) {\n      return;\n    }\n    const {\n      encointerScheduler: {\n        currentCeremonyIndex: getCurrentCeremonyIndex\n      }\n    } = api.query;\n    debug && console.log('ceremony id', currentPhase.phase, ceremonyIndex);\n    const CurrencyCeremony = api.registry.getOrUnknown('CurrencyCeremony');\n\n    /// Fetch participants and meetups counters\n    const fetchHistoricData = async (ceremony, phase, cids) => {\n      if (!apiReady(api, 'encointerCeremonies')) {\n        return;\n      }\n      const ceremonyNumber = ceremony.toNumber();\n      if (ceremonyNumber <= state.subscribtionCeremony && phase === 0) {\n        return;\n      }\n      const {\n        encointerCeremonies: {\n          participantCount: getParticipantCount,\n          meetupCount: getMeetupCount\n        }\n      } = api.query;\n      // Previous Phases of current Ceremony\n      for (let oldPhase = 0; oldPhase < phase; oldPhase++) {\n        cids.forEach(cid => {\n          const currencyCeremony = new CurrencyCeremony(api.registry, [cid, ceremony]);\n          const getters = [getParticipantCount, getMeetupCount];\n          const getter = getters[oldPhase];\n          debug && console.log('hist ', bs58.encode(cid), ceremony.toNumber(), oldPhase);\n          getter(currencyCeremony).then((_) => dispatch({\n            type: setters[oldPhase],\n            payload: {\n              cid: bs58.encode(cid),\n              count: _.toNumber()\n            }\n          }));\n        });\n      }\n    };\n\n    /// Fetch participants and meetups counters\n    const fetchLastCeremony = async (ceremony, cids) => {\n      if (!apiReady(api, 'encointerCeremonies')) {\n        return;\n      }\n      const {\n        encointerCeremonies: {\n          participantCount: getParticipantCount,\n          meetupCount: getMeetupCount\n        }\n      } = api.query;\n      // Last Ceremony\n      const lastCeremony = ceremony.sub(new U32(api.registry, 1));\n      const lastCeremonyData = await Promise.all(cids.map(cid => {\n        const currencyCeremony = new CurrencyCeremony(api.registry, [cid, lastCeremony]);\n        return api.queryMulti([\n          [getParticipantCount, currencyCeremony],\n          [getMeetupCount, currencyCeremony]\n        ]);\n      }));\n      const payload = lastCeremonyData.reduce((acc, data, idx) => {\n        const cid = bs58.encode(cids[idx]);\n        const [participantCount, meetupCount] = data;\n        acc.meetups[cid] = meetupCount.toNumber();\n        acc.participants[cid] = participantCount.toNumber();\n        acc.participantCount = acc.participants[cid] + acc.participantCount;\n        acc.meetupCount = acc.meetups[cid] + acc.meetupCount;\n        return acc;\n      }, {\n        subscribtionCeremony: lastCeremony.toNumber(),\n        meetups: {},\n        participants: {},\n        participantCount: 0,\n        meetupCount: 0\n      });\n      dispatch({\n        type: 'last',\n        payload\n      });\n    };\n\n    /// Subscription management via reducer\n    const subscribeToUpdates = async function (ceremony, phase, cids) {\n      if (!apiReady(api, 'encointerCeremonies')) {\n        return;\n      }\n      const ceremonyNumber = ceremony.toNumber();\n      if (ceremonyNumber <= state.subscribtionCeremony && phase <= state.subscribtionPhase) {\n        return;\n      }\n\n      debug && console.log('subscribe to ceremony', ceremonyNumber, phase);\n      const {\n        encointerCeremonies: {\n          participantCount: getParticipantCount,\n          attestationCount: getAttestationCount,\n          meetupCount: getMeetupCount\n        }\n      } = api.query;\n      const getters = [getParticipantCount, getMeetupCount, getAttestationCount];\n      const CurrencyCeremony = api.registry.getOrUnknown('CurrencyCeremony');\n      const unsubs = await Promise.all(cids.map(cid => {\n        const currencyCeremony = new CurrencyCeremony(api.registry, [cid, ceremonyIndex]);\n        const getter = getters[phase];\n        return getter(currencyCeremony, (_) => dispatch({\n          type: setters[phase],\n          payload: {\n            cid: bs58.encode(cid),\n            count: _.toNumber()\n          }\n        }));\n      }));\n\n      dispatch({\n        type: 'subscribe',\n        payload: {\n          subscribtions: unsubs,\n          subscribtionCeremony: ceremonyNumber,\n          subscribtionPhase: phase\n        }\n      });\n    };\n\n    if (!ceremonyIndex) {\n      getCurrentCeremonyIndex().then((currentCeremonyIndex) => {\n        debug && console.log('set ceremonyIndex', currentCeremonyIndex.toString());\n        setCeremonyIndex(currentCeremonyIndex);\n      });\n    }\n    if (ceremonyIndex &&\n        (ceremonyIndex.toNumber() !== state.subscribtionCeremony ||\n         currentPhase.phase !== state.subscribtionPhase) &&\n        cids.length) {\n      subscribeToUpdates(ceremonyIndex, currentPhase.phase, cids);\n      fetchHistoricData(ceremonyIndex, currentPhase.phase, cids);\n      !state.lastCeremony.subscribtionCeremony && fetchLastCeremony(ceremonyIndex, cids);\n    }\n    if (currentPhase.phase === ceremonyPhases.REGISTERING) {\n      state.subscribtionCeremony !== state.lastCeremony.subscribtionCeremony &&\n        dispatch({ type: 'reset' }); // reset state on start of new ceremony\n      getCurrentCeremonyIndex().then((currentCeremonyIndex) => {\n        debug && console.log('set ceremonyIndex', currentCeremonyIndex.toString());\n        setCeremonyIndex(currentCeremonyIndex);\n      });\n    }\n  }, [currentPhase.phase, ceremonyIndex, cids, es, debug, api, setters]);\n\n  /// Load currencies identifiers once\n  useEffect(() => {\n    debug && console.log('cids', cids);\n\n    if (ec && cids.length === 0) {\n      ec.currencyIdentifiers()\n        .then(cids => {\n          const hashes = cids.map(bs58.encode);\n          setCids(cids);\n          setHash(hashes);\n        })\n        .catch(err => console.error(err));\n    }\n  }, [cids, debug, ec]);\n\n  /// Get locations effect\n  useEffect(() => { /* eslint-disable react-hooks/exhaustive-deps */\n    debug && console.log('get locations');\n    if (cids.length && cids.length === hash.length) {\n      fetchGeodataPar(cids, hash);\n    }\n  }, [cids, hash]);\n\n  /// Attempt geolocation\n  useEffect(() => {\n    debug && console.log('get position');\n    const map = mapRef.current;\n    if (map != null && position === initialPosition) {\n      map.leafletElement.locate();\n    }\n  }, [mapRef, position]);\n\n  /// Update map after resize\n  useEffect(() => {\n    debug && console.log('update resize');\n    const map = mapRef.current && mapRef.current.leafletElement;\n    map && setTimeout(_ => map.invalidateSize(), 50);\n  }, [ui.sidebarSize]);\n\n  /// Handler generator for zoom in/out\n  function handlerZoom (s) {\n    return () => mapRef.current.leafletElement[s < 0 ? 'zoomOut' : 'zoomIn']();\n  }\n\n  /// Resize leaflet map when sidebar shown\n  function calcMapOffset () {\n    const full = '100%';\n    // should reposition markers in portrait mode if sidebar shown\n    if (ui.portrait && ui.selected && ui.sidebarSize && mapRef.current !== null) {\n      if (mapRef.current.container.style.height === '100%') {\n        const offset = mapRef.current.container.offsetHeight - ui.sidebarSize;\n        return `${offset}px`;\n      } else {\n        return mapRef.current.container.style.height;\n      }\n    }\n    return full;\n  }\n\n  /// Reset marker to my position\n  const handleLocationFound = e => {\n    setPosition(e.latlng);\n    const map = mapRef.current.leafletElement;\n    map.flyTo(e.latlng);\n    map.setZoom(8);\n  };\n\n  /// Handler for click on currency marker\n  const handleCurrencyMarkerClick = cid => {\n    const map = mapRef.current.leafletElement;\n    setUI({ ...ui, selected: cid, prevZoom: map.getZoom() });\n    const bounds = L.latLngBounds(data[cid].coords).pad(2);\n    map.fitBounds(bounds);\n  };\n\n  /// Handler for window resize\n  const handleResponsibleUpdate = (_, { width }) =>\n    setUI({ ...ui, portrait: width < Responsive.onlyMobile.maxWidth, width });\n\n  /// Handler for sidebar closing\n  const handleSidebarClosed = () => {\n    const map = mapRef.current.leafletElement;\n    map.setZoom(ui.prevZoom);\n    setUI({ ...ui, selected: '', sidebarSize: 0 });\n  };\n\n  /// Handler for sidebar shows completely\n  const handleSidebarShow = sidebarSize =>\n    setUI({ ...ui, sidebarSize, menu: false });\n\n  /// Show left side menu\n  const toggleMenu = () => setUI({\n    ...ui,\n    menu: !ui.menu,\n    selected: ui.menu ? ui.selected : '',\n    sidebarSize: ui.menu ? ui.sidebarSize : 0\n  });\n\n  /// Close left side menu if clicked\n  const handleMapClick = () =>\n    ui.menu && setUI({ ...ui, menu: false });\n\n  return (\n    <Responsive\n      as={Segment.Group}\n      className='encointer-map'\n      fireOnMount\n      onUpdate={handleResponsibleUpdate}>\n\n      <Sidebar.Pushable as={Segment}  className='component-wrapper'>\n\n        <MapMenu visible={ui.menu} />\n\n        <MapSidebar\n          onClose={handleSidebarClosed}\n          onShow={handleSidebarShow}\n          hash={ui.selected}\n          direction={ui.portrait ? 'bottom' : 'right'}\n          width='very wide'\n          data={data[ui.selected] || {}}\n          participantCount={ui.selected ? (state.participants[ui.selected] || 0) : 0}\n          lastParticipantCount={ui.selected ? state.lastCeremony.participants[ui.selected] : 0}\n          meetupCount={ui.selected ? (state.meetups[ui.selected] || 0) : 0}\n          lastMeetupCount={ui.selected ? state.lastCeremony.meetups[ui.selected] : 0}\n          debug={debug}\n        />\n\n        <Sidebar.Pusher className='encointer-map-wrapper'\n          style={{ marginRight: ui.portrait ? '0' : ui.sidebarSize + 'px' }}>\n\n          <MapCeremonyPhases\n            small={ui.portrait} participantCount={state.participantCount} meetupCount={state.meetupCount} attestationCount={state.attestationCount} currentPhase={currentPhase} />\n\n          <MapNodeInfo\n            style={ui.portrait && ui.selected ? { display: 'none' } : {}} />\n\n          <MapControl\n            onClick={toggleMenu}\n            loading={ui.loading}\n            onZoomIn={handlerZoom(1)}\n            onZoomOut={handlerZoom(-1)} />\n\n          <LMap\n            center={position}\n            zoom={4}\n            ref={mapRef}\n            zoomControl={false}\n            touchZoom={true}\n            onClick={handleMapClick}\n            style={{ height: calcMapOffset() }}\n            onLocationFound={handleLocationFound}>\n\n            <TileLayer {...tileSetup} />\n\n            { ui.selected\n              ? <LocationsLayer\n                participantCount={ui.selected ? (state.participants[ui.selected] || 0) : 0}\n                meetupCount={ui.selected ? (state.meetups[ui.selected] || 0) : 0}\n                attestationCount={ui.selected ? (state.attestations[ui.selected] || 0) : 0}\n                phase={currentPhase.phase}\n                data={data[ui.selected]}\n              />\n              : null }\n\n            { !ui.loading\n              ? <CommunitiesClusters\n                data={data}\n                cids={hash}\n                state={state}\n                onClick={handleCurrencyMarkerClick}\n                selected={ui.selected} />\n              : null }\n\n          </LMap>\n\n        </Sidebar.Pusher>\n\n      </Sidebar.Pushable>\n\n      { debug\n        ? <DeveloperConsole />\n        : null }\n\n    </Responsive>\n  );\n}\n","import React from 'react';\n\nimport 'semantic-ui-css/semantic.min.css';\nimport { SubstrateContextProvider } from './substrate-lib';\n\nimport Map from './Map';\nimport './style.css';\n\nfunction Main () {\n  return (<Map debug />);\n}\n\nexport default function App () {\n  return (\n    <SubstrateContextProvider>\n      <Main />\n    </SubstrateContextProvider>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(<App />,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}